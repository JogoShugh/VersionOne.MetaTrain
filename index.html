<!DOCTYPE html>
<html>
	<html>
	<head>
		<title>VersionOne MetaTrain</title>
		<meta name='viewport' content='width=device-width, initial-scale=1.0'>		
		<script src='lib/jquery/jquery-1.10.2.min.js'></script>	
		<script src='js/angular.min.js'></script>		
		<script src='js/angular-resource.min.js'></script>		
		<script src='js/underscore.min.js'></script>
		<script src='js/yaml.min.js'></script>
		<link href='//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css' rel='stylesheet' media='screen' />
		<script src='//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.4.0/ui-bootstrap-tpls.min.js'></script>       
		<link href='styles.css' rel='stylesheet' media='screen' />				
	</head>
	<body>

	<div ng-controller='HomeController'>
	 	<div class='container'>
	 		<div class='row'>
	 			<div class='col-md-12 well well-small'>
	 				<strong>Query path:</strong> <input ng-model='path.val' class='span12' />
	 			</div>
	 		</div>
	 	</div>
	 	<hr />
	   	<div class='container'>
			<div class='row'>
				<div class='span8'>
					<div ng-repeat='item in metaList' ng-cloak>
				     	<div ng-init='expanded = true' ng-show='item.visible'>				     		
				     		<a name='asset-type'></a><span ng-show='metaList.length != 1' ng-click='metaBack()'><i class='icon-circle-arrow-left'></i> <b>back</b>&nbsp;</span>				     		
				     		<strong>Asset Type</strong>: {{item.AssetName}} <i class='icon-plus' ng-click='expanded = !expanded'></i>
				     		<div ng-show='expanded' class='details'>
							  <tabset>
							  	<tab heading='Attributes'>
							  		<table class='table table-bordered table-striped table-nonfluid'>
							  			<tr>
							  				<th colspan='4' class='attribute-heading'>Scalar Attributes</th>
							  			</tr>
							  			<tr>
							  				<th>Name</th>
							  				<th><a href='http://community.versionone.com/VersionOne_Connect/Developer_Library/Getting_Started/Platform_Concepts/Attribute_Types' target='_blank'>Type</a></th>	  				
							  				<th colspan='2'>Meta Info</th>
							  			</tr>
							  			<tr ng-repeat='attr in item.Attributes'>  			
							  				<td class='attribute' ng-class='{selected: selected(attr.Name)}'>
							  					<i class='icon-ok' ng-show='!selected(attr.Name)' 
							  						ng-click='toggleSelect(attr.Name)'>&nbsp;</i>
							  					<i class='icon-remove' ng-show='selected(attr.Name)'
							  						ng-click='toggleSelect(attr.Name)'></i>
							  					{{attr.Name}} <i class='icon-filter' ng-click='toggleFilter(attr)'>&nbsp;</i>
							  					<div ng-show='attr.filterVisible' class='well well-small'>
							  						<div ng-repeat='filter in attr.filters'>
							  							<table border='0' cellpadding='0' cellspacing='0'>
							  								<tr style='border-top: 2px solid goldenrod'>
							  									<td>
							  										<span style='font-size: 80%' ng-click='filterRemove(attr, filter)'><i class='icon-minus-sign' label='Remove filter'>&nbsp;</i></span>
							  									</td>
							  									<td>
								  									<select style='width: 50px' ng-model='filter.operator'>
								  										<option value='none'></option>
								  										<option value='equal'>=</option>
											  							<option value='notEqual'>!=</option>
																		<option value='greaterThan'>&gt;</option>
																		<option value='greaterThanOrEqual'>&gt;=</option>
																		<option value='lessThan'>&lt;</option>
																		<option value='lessThanOrEqual'>&lt;=</option>
																		<option value='exists'>+ (exists)</option>
																		<option value='notExists'>- (not exists)</option>
								  									</select>
								  								</td>
								  								<td>
								  									<span ng-repeat='filterValue in filter.values'>
									  									<input type='text' ng-model='filterValue.value' />
									  									<i class='icon-remove' ng-click='filterValueRemove(filter, filterValue)'>&nbsp;</i>
									  									<br />
								  									</span>
									  								<span style='font-size: 70%; top: -10px; position: relative;' class><span ng-click='filterValueAdd(filter)'><i class='icon-plus'>&nbsp;</i> Add <b>OR</b> Value</span></span>
									  							</td>
									  						</tr>
									  					</table>
							  						</div>
							  						<div style='font-size: 80%; padding-top: 8px;' ng-click='filterAdd(attr)'><i class='icon-plus-sign'>&nbsp;</i> Add Filter</div>
							  						<div>
							  							<a class='btn btn-success btn-mini' ng-click='filtersUpdate(attr)'>Update</a>
							  						</div>
							  					</div>
							  				</td>
							  				<td>{{attr.AttributeType}}</td>			  				
							  				<td colspan='2'>
							  					<span class='badge badge-important' ng-show='attr.IsRequired'>required</span> <span class='badge badge-warning' ng-show='attr.IsReadOnly'>read only</span> <span class='badge badge-success' ng-show='!attr.IsReadOnly'>read/write</span>
							  				</td>
							  			</tr>
							  			<tr>
							  				<th colspan='4' class='attribute-heading'>Relations</th>
							  			</tr>
							  			<tr>
							  				<th>Name</th>
							  				<th>Type</th>
							  				<th>Relation to / from</th>
											<th>Meta Info</th>			
							  			</tr>
							  			<tr ng-repeat='rel in item.Relations'>
 											<td ng-click='toggleSelectRelation(rel.RelatedAsset.href, rel.Name)' ng-class='{selected: selectedRelation(rel.Name)}'>
							  					<i class='icon-ok' ng-show='!selectedRelation(rel.Name)'>&nbsp;</i>
							  					<i class='icon-remove' ng-show='selectedRelation(rel.Name)'></i>
							  					{{rel.Name}}
											</td>
							  				<td><span ng-show='!rel.IsMultivalue'>Single Value</span> <span ng-show='rel.IsMultivalue'>Multivalue</span>
							  				</td>
							  				<td class='relation'>{{rel.RelatedAsset.nameref}}
											  	<i class='icon-arrow-right'></i>&nbsp;<i class='icon-arrow-left'></i>&nbsp;{{rel.ReciprocalRelation.tokenref.split('.')[1]}}
							  				<td>
							  					<span class='badge badge-important' ng-show='rel.IsRequired'>required</span> <span class='badge badge-warning' ng-show='rel.IsReadOnly'>read only</span> <span class='badge badge-success' ng-show='!rel.IsReadOnly'>read/write</span>
							  				</td>
							  			</tr>
							  		</table>
								</tab>
							  	<tab heading='Operations'>
							  		{{item.Operations | json}}
								</tab>								
							  </tabset>
							</div>
						</div>
					</div>

				</div>
				<div class='span4'>
					<strong>Query Definition</strong>:<br />
					<pre class='well'>{{queryRender()}}</pre>
				</div>				
			</div>
	   	</div>
	</div> 			

	</body>

	<script src='app.coffee' type='text/coffeescript'></script>	
	<script type="text/javascript" src="js/coffee-script.min.js"></script>
</html>